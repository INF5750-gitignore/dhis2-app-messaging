<div class="container" ng-controller="ShowAllMessages" id="rootElement">

    <div class="header" id="messageListTitle">
        <div class="title">Messages</div>
        <span class="space"></span>
        <div ng-show="(messages|filter:unreadMessages).length" class="badge totalUnread">{{(messages|filter:unreadMessages).length}}</div>
        <div class="fa fa-signal connectionIcon" ng-class="{offline: online == false}"></div>
    </div>

    <nav class="row navbar navbar-default" role="navigation">
        <div class="container-fluid row">
            <!-- Add new message -->
            <div class="col-xs-2 col-sm-1">
                <a href="#/new" class="navbar-btn navbar-left btn btn-primary" aria-label="Left Align">
                    <span class="fa fa-plus" aria-hidden="true"></span>
                </a>
            </div>
                
            <!-- Search bar -->
            <div class="col-xs-9 col-sm-6 col-sm-push-3 col-md-7 col-md-push-2">
                <!-- navbar form from sm and up -->
                <form style="width: 100%;" class="hidden-xs navbar-form navbar-left" role="search">
                    <input style="width: 100%;" type="text" class="form-control" ng-model="searchText" placeholder="Search">
                </form>

                <form class="navbar-nav hidden-sm hidden-md hidden-lg navbar-left" role="search">
                    <div class="form-group">
                        <input class="form-control" type="text" id="searchBox" ng-model="searchText" placeholder="Search"></input>
                    </div>
                </form>
            </div>

            <div class="col-xs-5 col-sm-3 col-sm-pull-6 col-md-2 col-md-pull-7">
                <ul class="nav navbar-nav navbar-left">
                    <li class="dropdown">
                        <a href="" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">{{ messageFilter.display }} <span class="caret"></span></a>

                        <ul class="dropdown-menu" role="menu">
                            <li ng-repeat="filter in filters"><a ng-click="setFilter(filter)">{{ filter.display }}</a></li>
                        </ul>
                    </li>
                </ul>
            </div>

            <div class="col-xs-7 col-sm-2 right-dropdown pull-right">
                <ul class="nav navbar-nav navbar-right">
                    <li class="dropdown">
                        <a href="" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Options <span class="caret"></span></a>
                        <ul class="dropdown-menu" role="menu">
                            <li><a class="right-dropdown" href="" ng-click="selectAll()">Select all</a></li>
                            <li><a class="right-dropdown" href="" ng-click="selectNone()">Select none</a></li>
                            <li><a class="right-dropdown" href="" ng-click="updateReadStatus(true)">Mark as read</a></li>
                            <li><a class="right-dropdown" href="" ng-click="updateReadStatus(false)">Mark as unread</a></li>
                            <li class="divider"></li>
                            <li><a class="right-dropdown" href="" ng-click="delete()">Delete</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

	<div>
		<ul class="list-group">
			<li ng-repeat="message in messages | filter: searchFilter | orderBy:'created':true | filterMessageDisplay:messageFilter" class="row list-group-item message-list" ng-class="{unread: message.read == false}">


					<span class="col-xs-1 col-lg-1 messageGlyph">
						<input ng-model="message._selected" type="checkbox" value="{{ message.id }}" class="messageCheckbox"></input>
						<span class="glyphicon glyphicon-star star" ng-hide="message.followUp==false"></span>

					</span>

					<span>
						<a class="fillthespan" href="#msg/{{ message.id }}">
							<span class="col-xs-7 col-lg-4 ellipsize">
								<span ng-show="{{ getName(message).length }}" >{{ getName(message) }}</span>
								<span ng-hide="{{ getName(message).length }}" >(System message)</span>

								<span>({{message.messageCount}})</span>
							</span>

							<span class="col-xs-4 col-lg-2 col-lg-push-4 dateDisplay ellipsize"><span class="badge badge-info dateBadge">{{ message.created | date : 'dd MMM yyyy' }}</span></span>
							<span class="col-xs-12 col-lg-5 col-lg-pull-4 ellipsize">{{ message.displayName }}</span>
						</a>
					</div>


				<div ng-show="dhis.busy" class="loader">
					<span class="glyphicon glyphicon-refresh btn-lg spin"></span> Loading...
				</div>
				<div ng-hide="dhis.busy" class="loader">
					<span class="btn-lg"></span>
				</div>
			</li>
		</ul>
	</div>

</div>
